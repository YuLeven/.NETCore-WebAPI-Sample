version: '3.4'
volumes:
  haru-ga-kita-postgresql-ci:
services:
  postgres:
    image: postgres:10-alpine
    environment:
      POSTGRES_USER: harugakita
      password: password
    ports:
      - 5432:5432
    volumes:
      - haru-ga-kita-postgresql-ci:/var/lib/postgresql/data
  harugakita:
    build:
      context: .
      dockerfile: ./Dockerfile.ci
    environment:
      - DATABASE_URL=User ID=harugakita;Password=password;Server=postgres;Port=5432;Database=harugakita_test;Integrated Security=true;Pooling=true;
    links:
      - postgres
